<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fast Track</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="theme-color" content="#020617">
  <meta name="apple-mobile-web-app-title" content="Fast Track">
  <meta name="application-name" content="Fast Track">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" href="assets/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { theme: { extend: { colors: { brand: { 500: "#06b6d4", 600: "#0891b2" }}}}};
  </script>
  <script src="firebase-config.js"></script>
</head>
<body class="min-h-screen bg-app text-default">
  <div id="toast" class="fixed top-3 left-1/2 -translate-x-1/2 z-50 hidden px-3 py-2 rounded-full surface border border-default text-sm md:text-xs text-default"></div>
  <div id="nav-tooltip" class="fixed z-50 hidden px-2 py-1 rounded-md surface border border-default text-[11px] text-default pointer-events-none shadow-lg"></div>

  <div id="auth-screen" class="min-h-screen hidden px-4 py-10 flex items-center justify-center">
    <div class="w-full max-w-md surface-glass border border-default rounded-3xl p-6 md:p-5 shadow-xl">
      <div class="mb-5">
        <h2 id="auth-title" class="text-2xl md:text-xl font-semibold text-default">Welcome back</h2>
        <p id="auth-subtitle" class="text-sm md:text-xs text-muted mt-1">Sign in to keep your fasting history synced.</p>
      </div>

      <form id="auth-form" class="space-y-4">
        <div>
          <label for="auth-email" class="block text-sm md:text-xs text-muted mb-1">Email</label>
          <input id="auth-email" type="email" autocomplete="email" required class="w-full bg-app border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs text-default focus:outline-none focus:ring-1 focus:ring-brand-500">
        </div>
        <div>
          <label for="auth-password" class="block text-sm md:text-xs text-muted mb-1">Password</label>
          <input id="auth-password" type="password" autocomplete="current-password" required class="w-full bg-app border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs text-default focus:outline-none focus:ring-1 focus:ring-brand-500">
        </div>
        <label class="flex items-center gap-2 text-sm md:text-xs text-muted">
          <input id="auth-remember" type="checkbox" class="accent-cyan-400">
          Remember this device
        </label>
        <p class="text-xs md:text-[11px] text-subtle">
          Remember keeps your encrypted data accessible on this device without ever storing a plaintext password.
        </p>

        <p id="auth-error" class="text-sm md:text-xs text-danger hidden"></p>

        <button id="auth-submit" type="submit" class="w-full py-3 md:py-2.5 rounded-xl button-primary text-sm md:text-xs font-semibold">Sign in</button>
      </form>

      <div id="verify-email-panel" class="mt-4 hidden space-y-3 rounded-2xl border border-default surface-soft p-4 text-sm md:text-xs">
        <div class="text-default font-medium">Verify your email to continue</div>
        <p class="text-muted">
          We sent a verification link to <span id="verify-email-address" class="font-medium text-default"></span>.
          Open that email, then return here to finish setup.
        </p>
        <div class="flex flex-col gap-2">
          <button id="verify-email-refresh" type="button" class="w-full py-2.5 rounded-xl button-primary text-sm md:text-xs font-semibold">I've verified</button>
          <button id="verify-email-resend" type="button" class="w-full py-2.5 rounded-xl button-outline border text-sm md:text-xs font-medium">Resend email</button>
          <button id="verify-email-signout" type="button" class="w-full py-2.5 rounded-xl button-outline border text-sm md:text-xs font-medium">Use a different email</button>
        </div>
      </div>

      <div class="mt-4 text-sm md:text-xs text-muted text-center">
        <span id="auth-toggle-text">New here?</span>
        <button id="auth-toggle" type="button" class="font-medium ml-1">Create an account</button>
      </div>
    </div>
  </div>

  <div id="app" class="flex flex-col min-h-screen hidden">
    <header class="px-4 pt-4 md:pt-16 pb-3 flex items-center justify-between">
      <div class="flex flex-col">
        <h1 class="text-xl md:text-lg font-semibold tracking-tight">Fast Track</h1>
        <p id="header-subtitle" class="text-sm md:text-xs text-muted">No active fast</p>
      </div>
      <div class="flex items-center gap-2">
        <button id="fast-btn" class="text-sm md:text-xs px-3 py-2 md:py-1.5 rounded-full border button-outline text-default flex flex-col items-start leading-tight">
          <span id="fast-label-mode" class="text-[10px] md:text-[9px] uppercase tracking-[0.2em] text-subtle">Fast</span>
          <span id="fast-label-value" class="text-sm md:text-xs font-semibold">00:00:00</span>
        </button>
        <button id="calorie-btn" class="text-sm md:text-xs px-3 py-2 md:py-1.5 rounded-full border button-outline text-default flex flex-col items-start leading-tight">
          <span id="calorie-label-mode" class="text-[10px] md:text-[9px] uppercase tracking-[0.2em] text-subtle">Calories</span>
          <span id="calorie-label-value" class="text-sm md:text-xs font-semibold">Set target</span>
        </button>
        <button id="alerts-btn" class="text-sm md:text-xs px-3 py-2 md:py-1.5 rounded-full border button-outline text-default flex flex-col items-start leading-tight">
          <span id="alerts-label-mode" class="text-[10px] md:text-[9px] uppercase tracking-[0.2em] text-subtle">Alerts</span>
          <span class="text-sm md:text-xs font-semibold flex items-center gap-2">
            <span id="alerts-dot" class="w-2 h-2 md:w-1.5 md:h-1.5 rounded-full bg-subtle"></span>
            <span id="alerts-label-value">Enable alerts</span>
          </span>
        </button>
      </div>
    </header>

    <main class="flex-1 px-4 pb-28 md:pb-20 pt-2">
      <section id="tab-timer" class="h-full flex flex-col gap-6 md:gap-5">
        <div class="flex justify-center mt-6 md:mt-4">
          <div class="w-full max-w-md">
            <!-- Bigger ring -->
            <div class="ring-shell relative mx-auto">
              <svg viewBox="0 0 200 200" class="w-full h-full -rotate-90">
                <circle cx="100" cy="100" r="80" class="progress-ring-track" stroke-width="16" fill="none"></circle>
                <circle id="progress-ring" cx="100" cy="100" r="80" stroke-width="16" stroke-linecap="round" fill="none" stroke-dasharray="502.6548245743669" stroke-dashoffset="502.6548245743669"></circle>
              </svg>

              <div id="ring-emoji-layer" class="ring-emoji-layer absolute inset-0"></div>

              <div class="absolute inset-0 flex flex-col items-center justify-center select-none">
                <div class="mb-3">
                  <div id="timer-type" class="text-sm md:text-xs px-3 py-1 md:px-2 md:py-0.5 rounded-full">No fast selected</div>
                </div>

                <button id="timer-main" class="text-5xl md:text-4xl font-semibold tracking-tight px-3 py-2 rounded-2xl pressable-surface">00:00:00</button>
                <div id="timer-mode" class="text-xs md:text-[11px] uppercase tracking-[0.2em] text-subtle mt-1">Time Fasted</div>
                <div id="timer-sub" class="text-sm md:text-xs text-muted mt-2 md:mt-1">Tap time to change view</div>

                <div class="mt-4 md:mt-3">
                  <div id="timer-status" class="text-xs md:text-[11px] uppercase tracking-[0.2em] text-subtle">IDLE</div>
                </div>
              </div>
            </div>

            <div id="ring-emoji-panel" class="mt-4 rounded-2xl border border-default surface-soft px-4 py-3 text-center">
              <div id="ring-emoji-title" class="text-sm md:text-xs text-default">Tap an emoji to see what’s happening</div>
              <div id="ring-emoji-detail" class="text-xs md:text-[11px] text-muted mt-1"></div>
            </div>

            <!-- Started / Target end row under ring -->
            <div class="mt-4 flex items-start justify-between gap-3 text-sm md:text-xs text-muted">
              <div class="flex flex-col">
                <div class="text-[11px] md:text-[10px] uppercase tracking-[0.2em] text-subtle">Started</div>
                <button id="meta-start-btn" class="text-left text-default underline underline-offset-4 decoration-muted disabled:opacity-50 disabled:no-underline disabled:cursor-not-allowed" disabled>—</button>
              </div>
              <div class="flex flex-col items-end">
                <div class="text-[11px] md:text-[10px] uppercase tracking-[0.2em] text-subtle">Target end</div>
                <div id="meta-end" class="text-default">—</div>
              </div>
            </div>

          </div>
        </div>

        <div class="space-y-3 w-full max-w-md mx-auto">
          <button id="start-fast-btn" class="w-full py-4 md:py-3 rounded-full button-primary font-semibold text-base md:text-sm">Start Fast</button>
          <button id="stop-fast-btn" class="w-full py-4 md:py-3 rounded-full button-secondary border text-default font-semibold text-base md:text-sm hidden">Stop Fast</button>
        </div>

        <div class="mt-1">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-2 text-center">Fast types</h2>
          <div id="fast-type-chips" class="flex flex-wrap gap-2 justify-center w-full"></div>
          <div class="text-xs md:text-[11px] text-subtle mt-2 text-center">Select a type to preview, then tap “Use this fast type” to apply.</div>
        </div>
      </section>

      <section id="tab-history" class="h-full flex-col gap-4 hidden">
        <div class="mb-4">
          <div class="flex items-center justify-between mb-2">
            <button id="calendar-prev" class="p-3 md:p-2 rounded-full button-outline border text-sm md:text-xs">&lt;</button>
            <div id="calendar-label" class="text-base md:text-sm font-medium text-default"></div>
            <button id="calendar-next" class="p-3 md:p-2 rounded-full button-outline border text-sm md:text-xs">&gt;</button>
          </div>
          <div class="grid grid-cols-7 gap-1 text-[11px] md:text-[10px] text-center text-subtle mb-1">
            <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
          </div>
          <div id="calendar-grid" class="grid grid-cols-7 gap-1 text-sm md:text-xs"></div>
        </div>

        <div class="mb-3">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Selected day</h2>
          <div id="day-summary" class="text-sm md:text-xs text-muted mb-2 md:mb-1">No fasts logged</div>
          <div id="day-fast-list" class="space-y-2 text-sm md:text-xs"></div>
        </div>

        <div class="mb-3">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Notes</h2>
          <div id="day-notes-summary" class="text-sm md:text-xs text-muted mb-2 md:mb-1">No notes yet.</div>
          <div id="day-notes-list" class="space-y-2 text-sm md:text-xs"></div>
        </div>

        <div class="mt-2">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Recent fasts</h2>
          <div id="recent-fast-list" class="space-y-2 text-sm md:text-xs"></div>
        </div>
      </section>

      <section id="tab-calories" class="h-full flex-col gap-4 hidden">
        <div class="space-y-3">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Calories</h2>
          <div class="flex justify-center mt-4">
            <div class="w-full max-w-md">
              <div class="ring-shell relative mx-auto">
                <svg viewBox="0 0 200 200" class="w-full h-full -rotate-90">
                  <circle cx="100" cy="100" r="80" class="progress-ring-track" stroke-width="16" fill="none"></circle>
                  <circle id="calorie-progress-ring" cx="100" cy="100" r="80" stroke-width="16" stroke-linecap="round" fill="none" stroke-dasharray="502.6548245743669" stroke-dashoffset="502.6548245743669"></circle>
                </svg>

                <div id="calorie-ring-emoji-layer" class="ring-emoji-layer absolute inset-0"></div>

                <div class="absolute inset-0 flex flex-col items-center justify-center select-none">
                  <div class="mb-3">
                    <div id="calorie-ring-label" class="text-sm md:text-xs px-3 py-1 md:px-2 md:py-0.5 rounded-full">No target set</div>
                  </div>

                  <button id="calorie-ring-value" type="button" class="calorie-ring-value text-5xl md:text-4xl font-semibold tracking-tight px-3 py-2 rounded-2xl" aria-label="Change calorie view">0</button>
                  <div id="calorie-ring-sub" class="text-xs md:text-[11px] uppercase tracking-[0.2em] text-subtle mt-1">Calories</div>
                  <div id="calorie-ring-detail" class="text-sm md:text-xs text-muted mt-2 md:mt-1">Set a daily target to track progress.</div>
                </div>
              </div>

              <div id="calorie-tip-panel" class="mt-3 rounded-2xl border border-default surface-soft px-4 py-3 text-center">
                <div id="calorie-tip-title" class="text-sm md:text-xs text-default">Select a goal to see calorie tips</div>
                <div id="calorie-tip-detail" class="text-xs md:text-[11px] text-muted mt-1"></div>
              </div>
            </div>
          </div>
          <div class="surface border border-default rounded-2xl px-4 py-4 space-y-3">
            <div>
              <label class="block text-sm md:text-xs text-muted mb-1" for="calorie-daily-target-input">Daily target</label>
              <input id="calorie-daily-target-input" type="number" min="0" inputmode="numeric" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500" placeholder="e.g. 2000">
            </div>
            <div>
              <label class="block text-sm md:text-xs text-muted mb-1" for="calorie-consumed-input">Consumed today</label>
              <input id="calorie-consumed-input" type="number" min="0" inputmode="numeric" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500" placeholder="e.g. 1200">
            </div>
            <p id="calorie-summary" class="text-sm md:text-xs text-muted">Set a target to track remaining calories.</p>
          </div>
          <div class="surface border border-default rounded-2xl px-4 py-4 space-y-3">
            <h3 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Goal details</h3>
            <div class="grid gap-3 md:grid-cols-2">
              <div>
                <label class="block text-sm md:text-xs text-muted mb-1" for="calorie-goal-input">Goal</label>
                <select id="calorie-goal-input" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500">
                  <option value="">Select goal</option>
                  <option value="lose">Lose weight</option>
                  <option value="maintain">Maintain</option>
                  <option value="gain">Gain muscle</option>
                </select>
              </div>
              <div>
                <label class="block text-sm md:text-xs text-muted mb-1" for="calorie-gender-input">Gender</label>
                <select id="calorie-gender-input" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500">
                  <option value="">Select gender</option>
                  <option value="female">Female</option>
                  <option value="male">Male</option>
                  <option value="nonbinary">Non-binary</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div>
                <label class="block text-sm md:text-xs text-muted mb-1" for="calorie-fitness-input">Fitness level</label>
                <select id="calorie-fitness-input" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500">
                  <option value="">Select level</option>
                  <option value="sedentary">Sedentary</option>
                  <option value="light">Lightly active</option>
                  <option value="moderate">Moderately active</option>
                  <option value="active">Active</option>
                  <option value="athlete">Athlete</option>
                </select>
              </div>
              <div>
                <label class="block text-sm md:text-xs text-muted mb-1" for="calorie-age-input">Age</label>
                <input id="calorie-age-input" type="number" min="0" inputmode="numeric" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500" placeholder="e.g. 32">
              </div>
              <div>
                <label class="block text-sm md:text-xs text-muted mb-1" for="calorie-height-input">Height</label>
                <input id="calorie-height-input" type="number" min="0" inputmode="decimal" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500" placeholder="e.g. 170 cm">
              </div>
              <div>
                <label class="block text-sm md:text-xs text-muted mb-1" for="calorie-bmi-input">BMI</label>
                <input id="calorie-bmi-input" type="number" min="0" step="0.1" inputmode="decimal" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500" placeholder="e.g. 22.5">
              </div>
            </div>
          </div>
        </div>

      </section>

      <section id="tab-notes" class="notes-drawer hidden">
        <div class="notes-drawer-panel flex flex-col gap-4 bg-app border-l border-default p-4">
          <div class="notes-drawer-menu space-y-3 sticky top-0 z-10 surface-appbar backdrop-blur pb-4">
            <div>
              <h2 class="text-base md:text-sm font-medium text-default">Notes</h2>
              <p class="text-sm md:text-xs text-muted">Capture reflections, cravings, or wins alongside your fasts.</p>
            </div>
            <button id="new-note-btn" class="w-full py-4 md:py-3 rounded-full button-primary font-semibold text-base md:text-sm">New note</button>
          </div>

          <div class="notes-drawer-content flex-1 min-h-0 overflow-y-auto pt-4">
            <div id="notes-empty" class="note-empty hidden">
              <div id="notes-empty-title" class="text-default font-medium mb-1">No notes yet</div>
              <div id="notes-empty-body" class="text-sm md:text-xs text-muted">Start a new note to track how your fast feels.</div>
            </div>

            <div id="notes-list" class="space-y-3 mt-4"></div>
          </div>
        </div>
      </section>

      <section id="tab-settings" class="h-full flex-col gap-4 hidden">
        <div class="space-y-3">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Defaults</h2>
          <div>
            <label class="block text-sm md:text-xs text-muted mb-1">Default fast type</label>
            <select id="default-fast-select" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500"></select>
          </div>
        </div>

        <div class="mt-4 space-y-3">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Alerts</h2>
          <label class="flex items-center justify-between text-sm md:text-xs">
            <span class="text-muted">Alert when fast ends</span>
            <button id="toggle-end-alert" class="switch-btn"></button>
          </label>
          <label class="flex items-center justify-between text-sm md:text-xs">
            <span class="text-muted">Hourly reminder after end</span>
            <button id="toggle-hourly-alert" class="switch-btn"></button>
          </label>
          <p class="text-xs md:text-[11px] text-subtle">For best reliability, install the app (Add to Home Screen). Web alerts depend on OS/browser power rules.</p>
        </div>

        <div class="mt-4 space-y-3">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Display</h2>
          <label class="flex items-center justify-between text-sm md:text-xs">
            <span class="text-muted">Show timer emojis</span>
            <button id="toggle-ring-emojis" class="switch-btn"></button>
          </label>
        </div>

        <div class="mt-4 space-y-3">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Theme</h2>
          <label class="block text-sm md:text-xs text-muted">Theme preset</label>
          <select id="theme-preset-select" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500"></select>
          <div id="theme-custom-controls" class="space-y-3 hidden">
            <label class="flex items-center justify-between text-sm md:text-xs">
              <span class="text-muted">Primary color</span>
              <input id="theme-primary-color" type="color" class="theme-color-input">
            </label>
            <label class="flex items-center justify-between text-sm md:text-xs">
              <span class="text-muted">Secondary color</span>
              <input id="theme-secondary-color" type="color" class="theme-color-input">
            </label>
            <label class="flex items-center justify-between text-sm md:text-xs">
              <span class="text-muted">Background color</span>
              <input id="theme-background-color" type="color" class="theme-color-input">
            </label>
            <label class="flex items-center justify-between text-sm md:text-xs">
              <span class="text-muted">Surface color</span>
              <input id="theme-surface-color" type="color" class="theme-color-input">
            </label>
            <label class="flex items-center justify-between text-sm md:text-xs">
              <span class="text-muted">Surface muted color</span>
              <input id="theme-surface-muted-color" type="color" class="theme-color-input">
            </label>
            <label class="flex items-center justify-between text-sm md:text-xs">
              <span class="text-muted">Border color</span>
              <input id="theme-border-color" type="color" class="theme-color-input">
            </label>
            <label class="flex items-center justify-between text-sm md:text-xs">
              <span class="text-muted">Text color</span>
              <input id="theme-text-color" type="color" class="theme-color-input">
            </label>
            <label class="flex items-center justify-between text-sm md:text-xs">
              <span class="text-muted">Text muted color</span>
              <input id="theme-text-muted-color" type="color" class="theme-color-input">
            </label>
            <label class="flex items-center justify-between text-sm md:text-xs">
              <span class="text-muted">Danger color</span>
              <input id="theme-danger-color" type="color" class="theme-color-input">
            </label>
          </div>
          <p class="text-xs md:text-[11px] text-subtle">Colors sync across devices when you’re signed in.</p>
        </div>

        <div class="mt-4 space-y-3">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Data</h2>
          <button id="export-data" class="w-full py-3 md:py-2.5 rounded-xl button-outline border text-sm md:text-xs font-medium">Export history (CSV)</button>
          <button id="clear-data" class="w-full py-3 md:py-2.5 rounded-xl button-danger border text-sm md:text-xs font-medium">Clear all data</button>
        </div>

        <div class="mt-4 space-y-3">
          <h2 class="text-xs uppercase tracking-[0.2em] text-subtle mb-1">Account</h2>
          <button id="sign-out" class="w-full py-3 md:py-2.5 rounded-xl button-outline border text-sm md:text-xs font-medium">Sign out</button>
        </div>
      </section>
    </main>

    <nav class="fixed bottom-0 md:bottom-auto md:top-0 inset-x-0 border-t md:border-t-0 md:border-b border-default surface-appbar backdrop-blur pb-[env(safe-area-inset-bottom)] md:pb-0 md:pt-[env(safe-area-inset-top)]">
      <div class="flex h-20 md:h-14">
        <button data-tab="timer" data-label="Timer" class="nav-btn flex-1 flex items-center justify-center text-default nav-btn-active">
          <div class="flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2">
            <svg class="w-7 h-7 md:w-5 md:h-5" viewBox="0 0 20 20" fill="currentColor">
              <path d="M16.32 7.1A8 8 0 1 1 9 4.06V2h2v2.06c1.46.18 2.8.76 3.9 1.62l1.46-1.46l1.42 1.42l-1.46 1.45zM10 18a6 6 0 1 0 0-12a6 6 0 0 0 0 12zM7 0h6v2H7V0zm5.12 8.46l1.42 1.42L10 13.4L8.59 12l3.53-3.54z"/>
            </svg>
            <span class="hidden md:inline text-xs">Timer</span>
          </div>
        </button>

        <button data-tab="history" data-label="History" class="nav-btn flex-1 flex items-center justify-center text-subtle">
          <div class="flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2">
            <svg class="w-7 h-7 md:w-5 md:h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
              <path d="M12 8v4l2 2"/>
              <path d="M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5"/>
            </svg>
            <span class="hidden md:inline text-xs">History</span>
          </div>
        </button>

        <button data-tab="calories" data-label="Calories" class="nav-btn flex-1 flex items-center justify-center text-subtle">
          <div class="flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2">
            <svg class="w-7 h-7 md:w-5 md:h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
              <path d="M4 18c0-5 3-9 8-9s8 4 8 9"/>
              <path d="M12 9V4"/>
              <path d="M8 4h8"/>
            </svg>
            <span class="hidden md:inline text-xs">Calories</span>
          </div>
        </button>

        <button data-tab="notes" data-label="Notes" class="nav-btn flex-1 flex items-center justify-center text-subtle">
          <div class="flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2">
            <svg class="w-7 h-7 md:w-5 md:h-5" viewBox="0 0 24 24" fill="currentColor">
              <path d="M16 14H8a1 1 0 0 0 0 2h8a1 1 0 0 0 0-2Zm0-4h-6a1 1 0 0 0 0 2h6a1 1 0 0 0 0-2Zm4-6h-3V3a1 1 0 0 0-2 0v1h-2V3a1 1 0 0 0-2 0v1H9V3a1 1 0 0 0-2 0v1H4a1 1 0 0 0-1 1v14a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3V5a1 1 0 0 0-1-1Zm-1 15a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V6h2v1a1 1 0 0 0 2 0V6h2v1a1 1 0 0 0 2 0V6h2v1a1 1 0 0 0 2 0V6h2Z"/>
            </svg>
            <span class="hidden md:inline text-xs">Notes</span>
          </div>
        </button>

        <button data-tab="settings" data-label="Settings" class="nav-btn flex-1 flex items-center justify-center text-subtle">
          <div class="flex flex-col md:flex-row items-center justify-center gap-1 md:gap-2">
            <svg class="w-7 h-7 md:w-5 md:h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
              <path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 0 0-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 0 0-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 0 0-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 0 0-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 0 0 1.066-2.573c-.94-1.543.826-3.31 2.37-2.37c1 .608 2.296.07 2.572-1.065z"/>
              <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0-6 0"/>
            </svg>
            <span class="hidden md:inline text-xs">Settings</span>
          </div>
        </button>
      </div>
    </nav>
  </div>

  <div id="fast-type-modal" class="fixed inset-0 z-30 hidden">
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="modal-sheet absolute bottom-0 rounded-t-3xl bg-app border-t border-default p-4 max-h-[65vh] overflow-y-auto">
      <div class="flex items-center justify-between mb-2">
        <div>
          <div id="modal-type-label" class="text-base md:text-sm font-medium text-default"></div>
          <div id="modal-type-duration" class="text-xs md:text-[11px] text-muted"></div>
        </div>
        <button id="modal-close" class="text-sm md:text-xs px-3 py-2 md:px-2 md:py-1 rounded-full button-outline border">Close</button>
      </div>
      <ul id="modal-bullets" class="list-disc list-inside text-sm md:text-xs text-muted space-y-1 mb-3"></ul>
      <button id="modal-use-type" class="w-full py-3 md:py-2.5 rounded-full button-primary text-sm md:text-xs font-semibold">Use this fast type</button>
    </div>
  </div>

  <div id="confirm-fast-modal" class="fixed inset-0 z-40 hidden">
    <div class="confirm-fast-backdrop absolute inset-0 bg-black/50"></div>
    <div class="modal-sheet absolute bottom-0 rounded-t-3xl bg-app border-t border-default p-4">
      <div class="flex items-center justify-between mb-2">
        <div id="confirm-fast-title" class="text-base md:text-sm font-medium text-default">Start this fast?</div>
        <button id="confirm-fast-close" class="text-sm md:text-xs px-3 py-2 md:px-2 md:py-1 rounded-full button-outline border">Close</button>
      </div>
      <p id="confirm-fast-message" class="text-sm md:text-xs text-muted mb-4"></p>
      <div class="flex gap-2">
        <button id="confirm-fast-accept" class="flex-1 py-3 md:py-2.5 rounded-xl button-primary text-sm md:text-xs font-semibold">Confirm</button>
      </div>
    </div>
  </div>

  <div id="edit-start-modal" class="fixed inset-0 z-40 hidden">
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="modal-sheet absolute bottom-0 rounded-t-3xl bg-app border-t border-default p-4">
      <div class="flex items-center justify-between mb-3">
        <div class="text-base md:text-sm font-medium text-default">Edit start time</div>
        <button id="edit-start-close" class="text-sm md:text-xs px-3 py-2 md:px-2 md:py-1 rounded-full button-outline border">Close</button>
      </div>
      <label class="block text-sm md:text-xs text-muted mb-1">Start time</label>
      <input id="edit-start-input" type="datetime-local" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500">
      <div class="flex gap-2 mt-3">
        <button id="edit-start-now" class="flex-1 py-3 md:py-2.5 rounded-xl button-outline border text-sm md:text-xs font-medium">Set to now</button>
        <button id="edit-start-save" class="flex-1 py-3 md:py-2.5 rounded-xl button-primary text-sm md:text-xs font-semibold">Save</button>
      </div>
      <div class="text-xs md:text-[11px] text-subtle mt-2">End time updates automatically to keep the planned duration.</div>
    </div>
  </div>

  <div id="edit-history-modal" class="fixed inset-0 z-40 hidden">
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="modal-sheet absolute bottom-0 rounded-t-3xl bg-app border-t border-default p-4">
      <div class="flex items-center justify-between mb-3">
        <div class="text-base md:text-sm font-medium text-default">Edit completed fast</div>
        <button id="edit-history-close" class="text-sm md:text-xs px-3 py-2 md:px-2 md:py-1 rounded-full button-outline border">Close</button>
      </div>
      <label class="block text-sm md:text-xs text-muted mb-1">Start time</label>
      <input id="edit-history-start" type="datetime-local" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500">
      <div class="flex gap-2 mt-2">
        <button id="edit-history-start-now" class="flex-1 py-3 md:py-2.5 rounded-xl button-outline border text-sm md:text-xs font-medium">Set start to now</button>
      </div>
      <label class="block text-sm md:text-xs text-muted mb-1 mt-3">End time</label>
      <input id="edit-history-end" type="datetime-local" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500">
      <div class="flex gap-2 mt-2">
        <button id="edit-history-end-now" class="flex-1 py-3 md:py-2.5 rounded-xl button-outline border text-sm md:text-xs font-medium">Set end to now</button>
        <button id="edit-history-save" class="flex-1 py-3 md:py-2.5 rounded-xl button-primary text-sm md:text-xs font-semibold">Save</button>
      </div>
      <div class="flex gap-2 mt-2">
        <button id="edit-history-delete" class="flex-1 py-3 md:py-2.5 rounded-xl button-danger border text-sm md:text-xs font-medium">Delete fast</button>
      </div>
      <div class="text-xs md:text-[11px] text-subtle mt-2">Duration updates automatically when you save.</div>
    </div>
  </div>

  <div id="note-editor-modal" class="note-editor-modal fixed inset-0 hidden">
    <div class="note-editor-backdrop absolute inset-0 bg-black/50"></div>
    <div class="note-editor-panel bg-app border-l border-default p-4 rounded-l-3xl shadow-2xl">
      <div class="flex items-center justify-between mb-3">
        <div class="text-base md:text-sm font-medium text-default">Note</div>
        <button id="note-editor-close" class="text-sm md:text-xs px-3 py-2 md:px-2 md:py-1 rounded-full button-outline border">Close</button>
      </div>
      <div class="flex flex-wrap items-center gap-2 mb-3">
        <span id="note-editor-fast" class="note-badge"></span>
        <span id="note-editor-date" class="text-xs md:text-[11px] text-muted"></span>
      </div>
      <label for="note-editor-content" class="block text-sm md:text-xs text-muted mb-1">Note content</label>
      <textarea id="note-editor-content" rows="5" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500" placeholder="What do you want to remember?"></textarea>
      <label for="note-editor-calories" class="block text-sm md:text-xs text-muted mb-1 mt-3">Calories</label>
      <input id="note-editor-calories" type="number" min="0" step="1" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500" placeholder="0">
      <label for="note-editor-food-note" class="block text-sm md:text-xs text-muted mb-1 mt-3">Food notes</label>
      <textarea id="note-editor-food-note" rows="3" class="w-full surface border border-default rounded-xl px-3 py-3 md:py-2 text-sm md:text-xs focus:outline-none focus:ring-1 focus:ring-brand-500" placeholder="What did you eat?"></textarea>
      <div class="flex gap-2 mt-3">
        <button id="note-editor-delete" class="flex-1 py-3 md:py-2.5 rounded-xl button-danger border text-sm md:text-xs font-medium hidden">Delete</button>
        <button id="note-editor-save" class="flex-1 py-3 md:py-2.5 rounded-xl button-primary text-sm md:text-xs font-semibold">Save note</button>
      </div>
    </div>
  </div>

  <script src="script.js" type="module"></script>
</body>
</html>
